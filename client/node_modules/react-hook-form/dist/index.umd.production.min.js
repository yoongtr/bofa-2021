!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).ReactHookForm={},e.React)}(this,(function(e,r){"use strict";function t(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(t[n[s]]=e[n[s]])}return t}var n=e=>void 0===e,s=e=>null==e;const c=e=>"object"==typeof e;var u=e=>!s(e)&&!Array.isArray(e)&&c(e)&&!(e instanceof Date),i=e=>e.filter(Boolean),a=(e={},r,t)=>{const c=i(r.split(/[,[\].]+?/)).reduce((e,r)=>s(e)?e:e[r],e);return n(c)||c===e?n(e[r])?t:e[r]:c},o=e=>/^\w*$/.test(e),l=e=>i(e.replace(/["|']/g,"").replace(/\[/g,".").replace(/\]/g,"").split("."));function f(e,r,t){let n=-1;const s=o(r)?[r]:l(r),c=s.length,i=c-1;for(;++n<c;){const r=s[n];let c=t;if(n!==i){const t=e[r];c=u(t)||Array.isArray(t)?t:isNaN(+s[n+1])?{}:[]}e[r]=c,e=e[r]}return e}const d=(e,r,s)=>{for(const c of s||Object.keys(e)){const s=a(e,c);if(s){const{_f:e}=s,c=t(s,["_f"]);if(e&&r(e.name)){if(e.ref.focus&&n(e.ref.focus()))break;if(e.refs){e.refs[0].focus();break}}else u(c)&&d(c,r)}}};var y=e=>s(e)||!c(e);function b(e,t,n){if(y(e)||y(t)||e instanceof Date||t instanceof Date)return e===t;if(!r.isValidElement(e)){const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(const s of r){const r=e[s];if(!n||"ref"!==s){const e=t[s];if((u(r)||Array.isArray(r))&&(u(e)||Array.isArray(e))?!b(r,e,n):r!==e)return!1}}}return!0}function g(e,r,t,n,s){let c=-1;for(;++c<e.length;){for(const n in e[c])Array.isArray(e[c][n])?(!t[c]&&(t[c]={}),t[c][n]=[],g(e[c][n],a(r[c]||{},n,[]),t[c][n],t[c],n)):b(a(r[c]||{},n),e[c][n])?f(t[c]||{},n):t[c]=Object.assign(Object.assign({},t[c]),{[n]:!0});n&&!t.length&&delete n[s]}return t}var m=(e,r,t)=>function e(r,t){if(y(r)||y(t))return t;for(const n in t){const s=r[n],c=t[n];try{r[n]=u(s)&&u(c)||Array.isArray(s)&&Array.isArray(c)?e(s,c):c}catch(e){}}return r}(g(e,r,t.slice(0,e.length)),g(r,e,t.slice(0,e.length))),h=e=>u(e)&&!Object.keys(e).length;const v="blur",p="onBlur",x="onChange",A="onSubmit",O="onTouched",j="all",k="undefined",V="max",F="min",R="maxLength",S="minLength",w="pattern",C="required",D="validate";var _=(e,r,t)=>h(e)||Object.keys(e).length>=Object.keys(r).length||Object.keys(e).find(e=>r[e]===(!t||j)),E=(e,{valueAsNumber:r,valueAsDate:t,setValueAs:n},s)=>s?r?""===e?NaN:+e:t?new Date(e):n?n(e):e:e;const B=(e,r,n,s={})=>{for(const c in e.current){const u=e.current[c];if(u){const{_f:e}=u,i=t(u,["_f"]);f(s,c,e&&!e.ref.disabled?E(e.value,e,n):Array.isArray(u)?[]:{}),i&&B({current:i},r,n,s[c])}}return Object.assign(Object.assign({},r.current),s)},N={isValid:!1,value:null};var T=e=>Array.isArray(e)?e.reduce((e,r)=>r&&r.checked?{isValid:!0,value:r.value}:e,N):N,M=e=>"radio"===e.type,I=e=>"file"===e.type,$=e=>"checkbox"===e.type,P=e=>"select-multiple"===e.type;const W={value:!1,isValid:!1},L={value:!0,isValid:!0};var q=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(e=>e&&e.checked).map(({value:e})=>e);return{value:r,isValid:!!r.length}}const{checked:r,value:t,attributes:s}=e[0];return r?s&&!n(s.value)?n(t)?L:{value:t,isValid:!0}:L:W}return W};function H(e,r){if(e&&e._f){const{ref:n}=e._f;if(n.disabled)return;return I(n)?n.files:M(n)?T(e._f.refs).value:P(n)?(t=n.options,[...t].filter(({selected:e})=>e).map(({value:e})=>e)):$(n)?q(e._f.refs).value:E(n.value,e._f,r)}var t}var z=e=>e instanceof RegExp,G=e=>u(e)&&!z(e)?e:{value:e,message:""},J=e=>"string"==typeof e,K=e=>"function"==typeof e,Q=e=>"boolean"==typeof e,U=e=>J(e)||r.isValidElement(e);function X(e,r,t="validate"){if(U(e)||Q(e)&&!e)return{type:t,message:U(e)?e:"",ref:r}}var Y=(e,r,t,n,s)=>r?Object.assign(Object.assign({},t[e]),{types:Object.assign(Object.assign({},t[e]&&t[e].types?t[e].types:{}),{[n]:s||!0})}):{},Z=async({_f:{ref:e,refs:r,required:t,maxLength:n,minLength:c,min:i,max:a,pattern:o,validate:l,name:f,value:d}},y)=>{const b={},g=M(e),m=$(e),v=g||m,p=!d||Array.isArray(d)&&!d.length,x=Y.bind(null,f,y,b),A=(r,t,n,s=R,c=S)=>{const u=r?t:n;b[f]=Object.assign({type:r?s:c,message:u,ref:e},x(r?s:c,u))};if(t&&(!g&&!m&&(p||s(d))||Q(d)&&!d||m&&!q(r).isValid||g&&!T(r).isValid)){const{value:n,message:s}=U(t)?{value:!!t,message:t}:G(t);if(n&&(b[f]=Object.assign({type:C,message:s,ref:v?(r||[])[0]||{}:e},x(C,s)),!y))return b}if(!(s(i)&&s(a)||""===d)){let r,t;const n=G(a),c=G(i);if(isNaN(d)){const s=e.valueAsDate||new Date(d);J(n.value)&&(r=s>new Date(n.value)),J(c.value)&&(t=s<new Date(c.value))}else{const u=e.valueAsNumber||parseFloat(d);s(n.value)||(r=u>n.value),s(c.value)||(t=u<c.value)}if((r||t)&&(A(!!r,n.message,c.message,V,F),!y))return b}if(J(d)&&!p&&(n||c)){const e=G(n),r=G(c),t=!s(e.value)&&d.length>e.value,u=!s(r.value)&&d.length<r.value;if((t||u)&&(A(t,e.message,r.message),!y))return b}if(J(d)&&o&&!p){const{value:r,message:t}=G(o);if(z(r)&&!r.test(d)&&(b[f]=Object.assign({type:w,message:t,ref:e},x(w,t)),!y))return b}if(l){const t=v&&r?r[0]:e;if(K(l)){const e=X(await l(d),t);if(e&&(b[f]=Object.assign(Object.assign({},e),x(D,e.message)),!y))return b}else if(u(l)){let e={};for(const[r,n]of Object.entries(l)){if(!h(e)&&!y)break;const s=X(await n(d),t,r);s&&(e=Object.assign(Object.assign({},s),x(r,s.message)),y&&(b[f]=e))}if(!h(e)&&(b[f]=Object.assign({ref:t},e),!y))return b}}return b},ee=e=>e.substring(0,e.search(/.\d/))||e,re=(e,r)=>[...e].some(e=>ee(r)===e),te=(e,r,t,n,s=!0)=>e?new Proxy(r,{get:(e,r)=>{if(r in e)return t.current[r]!==j&&(t.current[r]=!s||j),n&&(n.current[r]=!0),e[r]}}):r;class ne{constructor(){this.tearDowns=[]}add(e){this.tearDowns.push(e)}unsubscribe(){for(const e of this.tearDowns)e();this.tearDowns=[]}}class se{constructor(e,r){this.observer=e,this.closed=!1,r.add(()=>this.closed=!0)}next(e){this.closed||this.observer.next(e)}}class ce{constructor(){this.observers=[]}next(e){for(const r of this.observers)r.next(e)}subscribe(e){const r=new ne,t=new se(e,r);return this.observers.push(t),r}unsubscribe(){this.observers=[]}}var ue=typeof window!==k&&typeof document!==k;const ie=ue?"Proxy"in window:typeof Proxy!==k,ae=(e,r,t=[])=>{for(const n in r)y(r[n])?t.push(`${e}.${n}`):ae(`${e}.${n}`,r[n],t);return t};function oe(e,r){const t=o(r)?[r]:l(r),s=1==t.length?e:function(e,r){const t=r.slice(0,-1).length;let s=0;for(;s<t;)e=n(e)?s++:e[r[s++]];return e}(e,t),c=t[t.length-1];let i;s&&delete s[c];for(let r=0;r<t.slice(0,-1).length;r++){let n,s=-1;const c=t.slice(0,-(r+1)),a=c.length-1;for(r>0&&(i=e);++s<c.length;){const r=c[s];n=n?n[r]:e[r],a===s&&(u(n)&&h(n)||Array.isArray(n)&&!n.filter(e=>u(e)&&!h(e)||Q(e)).length)&&(i?delete i[r]:delete e[r]),i=n}}return e}var le=e=>({isOnSubmit:!e||e===A,isOnBlur:e===p,isOnChange:e===x,isOnAll:e===j,isOnTouch:e===O}),fe=e=>e instanceof HTMLElement;function de(e,r){const t={};for(const n of e){const e=a(r,n);e&&(o(n)?t[n]=e._f:f(t,n,e._f))}return t}const ye=typeof window===k;const be=r.createContext(null);be.displayName="RHFContext";const ge=()=>r.useContext(be);var me=()=>{const e=typeof performance===k?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const t=(16*Math.random()+e)%16|0;return("x"==r?t:3&t|8).toString(16)})},he=(e=[],r)=>e.map(e=>Object.assign({[r]:e&&e[r]||me()},e));var ve=(e,r)=>n(r)?[]:function(e,r){let t=0;const n=[...e];for(const e of r)n.splice(e-t,1),t++;return i(n).length?n:[]}(e,(Array.isArray(r)?r:[r]).sort()),pe=(e,r,t)=>Array.isArray(e)?(n(e[t])&&(e[t]=void 0),e.splice(t,0,e.splice(r,1)[0]),e):[],xe=(e,r,t)=>{const n=[e[t],e[r]];e[r]=n[0],e[t]=n[1]};function Ae(e,r){return[...Array.isArray(r)?r:[r||void 0],...e]}function Oe(e,r,t){return[...e.slice(0,r),...Array.isArray(t)?t:[t],...e.slice(r)]}var je=e=>Array.isArray(e)?Array(e.length).fill(void 0):void 0;function ke({control:e}={}){const t=ge(),{formStateRef:n,formStateSubjectRef:s,readFormStateRef:c}=e||t.control,[u,i]=r.useState(n.current),a=r.useRef(function e(r){let t;if(y(r)||ue&&(r instanceof File||fe(r)))return r;if(r instanceof Date)return t=new Date(r.getTime()),t;if(r instanceof Set){t=new Set;for(const e of r)t.add(e);return t}if(r instanceof Map){t=new Map;for(const n of r.keys())t.set(n,e(r.get(n)));return t}t=Array.isArray(r)?[]:{};for(const n in r)t[n]=e(r[n]);return t}(c.current));return r.useEffect(()=>{const e=s.current.subscribe({next:e=>{_(e,a.current)&&i(Object.assign(Object.assign({},n.current),e))}});return()=>e.unsubscribe()},[]),te(ie,u,c,a,!1)}function Ve({name:e,rules:t,defaultValue:s,control:c}){const i=ge(),{defaultValuesRef:o,register:l,fieldsRef:f,fieldArrayNamesRef:d,controllerSubjectRef:b}=c||i.control,{onChange:g,onBlur:m,ref:h}=l(e,t),p=()=>a(f.current,e)&&n(a(f.current,e)._f.value)||re(d.current,e)?n(s)?a(o.current,e):s:a(f.current,e)._f.value,[x,A]=r.useState(p()),{errors:O,dirtyFields:j,touchedFields:k,isValidating:V}=ke({control:c||i.control});return r.useEffect(()=>{a(f.current,e)&&(a(f.current,e)._f.value=p());const r=b.current.subscribe({next:r=>A(a(r,e))});return()=>r.unsubscribe()},[]),{field:{onChange:r=>{const t=(e=>y(e)||!u(e.target)||u(e.target)&&!e.type?e:n(e.target.value)?e.target.checked:e.target.value)(r);A(t),g({target:{value:t,name:e}})},onBlur:()=>{m({target:{name:e},type:v})},name:e,value:x,ref:h},meta:{invalid:!!a(O,e),isDirty:!!a(j,e),isTouched:!!a(k,e),error:a(O,e),isValidating:V}}}e.Controller=e=>e.render(Ve(e)),e.FormProvider=e=>{var{children:n}=e,s=t(e,["children"]);return r.createElement(be.Provider,{value:s},n)},e.appendErrors=Y,e.get=a,e.set=f,e.transformToNestObject=(e,r={})=>{for(const t in e)o(t)?r[t]=e[t]:f(r,t,e[t]);return r},e.useController=Ve,e.useFieldArray=({control:e,name:s,keyName:c="id"})=>{const u=ge(),o=r.useRef(""),{isWatchAllRef:l,watchFieldsRef:y,getFormIsDirty:b,watchSubjectRef:g,fieldArraySubjectRef:h,fieldArrayNamesRef:v,fieldsRef:p,defaultValuesRef:x,formStateRef:A,formStateSubjectRef:O,readFormStateRef:j,validFieldsRef:k,fieldsWithValidationRef:V,fieldArrayDefaultValuesRef:F}=e||u.control,[R,S]=r.useState(he(a(F.current,ee(s))?a(F.current,s,[]):a(x.current,s,[]),c));f(F.current,s,[...R]),v.current.add(s);const w=e=>e.map((e={})=>{var r=c;e[r];return t(e,["symbol"==typeof r?r:r+""])}),C=()=>{const e=a(B(p,x),s,[]);return he(a(F.current,s,[]).map((r,t)=>Object.assign(Object.assign({},r),e[t])),c)},D=(e,r)=>{if(r){if(!n(r.focusIndex))return`${s}.${r.focusIndex}`;if(r.focusName)return r.focusName;if(!r.shouldFocus)return""}return`${s}.${e}`},_=e=>{S(he(e,c)),h.current.next({name:s,fields:w([...e])})},E=e=>!i(a(e,s,[])).length&&oe(e,s),N=e=>e&&f(A.current.dirtyFields,s,m(w(e),a(x.current,s,[]),a(A.current.dirtyFields,s,[]))),T=(e,r,t,n=[],c=!0,u=!1)=>{if(a(p.current,s)){const t=e(a(p.current,s),r.argA,r.argB);c&&f(p.current,s,t)}if(Array.isArray(a(A.current.errors,s))){const t=e(a(A.current.errors,s),r.argA,r.argB);c&&f(A.current.errors,s,t),E(A.current.errors)}if(j.current.touchedFields&&a(A.current.touchedFields,s)){const t=e(a(A.current.touchedFields,s),r.argA,r.argB);c&&f(A.current.touchedFields,s,t),E(A.current.touchedFields)}(j.current.dirtyFields||j.current.isDirty)&&(f(A.current.dirtyFields,s,m(w(n),a(x.current,s,[]),a(A.current.dirtyFields,s,[]))),N(t),E(A.current.dirtyFields)),u&&j.current.isValid&&(f(k.current,s,e(a(k.current,s,[]),r.argA)),E(k.current),f(V.current,s,e(a(V.current,s,[]),r.argA)),E(V.current)),O.current.next({isDirty:b(s,w(n)),errors:A.current.errors,isValid:A.current.isValid})};return r.useEffect(()=>{if(l.current)O.current.next({});else for(const e of y.current)if(s.startsWith(e)){O.current.next({});break}g.current.next({name:s}),o.current&&d(p.current,e=>e.startsWith(o.current)),o.current=""},[R,s]),r.useEffect(()=>{const e=h.current.subscribe({next({name:e,fields:r,isReset:t}){if(t)if(e){const t=B(p,x);f(t,e,r),f(F.current,s,r),_(a(t,s))}else F.current=r,_(a(r,s))}});return()=>{e.unsubscribe(),oe(F.current,s),v.current.delete(s)}},[]),{swap:r.useCallback((e,r)=>{const t=C();xe(t,e,r),T(xe,{argA:e,argB:r},void 0,t,!1),_(t)},[s]),move:r.useCallback((e,r)=>{const t=C();pe(t,e,r),_(t),T(pe,{argA:e,argB:r},void 0,t,!1)},[s]),prepend:r.useCallback((e,r)=>{const t=Ae(C(),Array.isArray(e)?e:[e]);_(t),T(Ae,{argA:je(e)},t),o.current=D(0,r)},[s]),append:r.useCallback((e,r)=>{const t=Array.isArray(e)?e:[e],n=[...C(),...t];_(n),(j.current.dirtyFields||j.current.isDirty)&&(N(n),O.current.next({isDirty:!0,dirtyFields:A.current.dirtyFields})),o.current=D(n.length-1,r)},[s]),remove:r.useCallback(e=>{const r=C(),t=ve(r,e);(e=>{(Array.isArray(e)?e:[e]).forEach(e=>f(p.current,`${s}${e?"."+e:""}`,[]))})(e),T(ve,{argA:e},t,ve(r,e),!0,!0),_(t)},[s]),insert:r.useCallback((e,r,t)=>{const n=C(),s=Oe(n,e,Array.isArray(r)?r:[r]);_(s),T(Oe,{argA:e,argB:je(r)},s,n&&Oe(n,e)),o.current=D(e,t)},[s]),fields:R}},e.useForm=function({mode:e=A,reValidateMode:c=x,resolver:u,context:o,defaultValues:l={},shouldFocusError:y=!0,criteriaMode:g}={}){const p=r.useRef({}),O=r.useRef(new Set),k=r.useRef(new ce),V=r.useRef(new ce),F=r.useRef(new ce),R=r.useRef(new ce),S=r.useRef({}),w=r.useRef({}),C=r.useRef(new Set),D=r.useRef(!1),E=r.useRef({}),N=r.useRef({}),T=r.useRef(l),W=r.useRef(!1),L=r.useRef(o),q=r.useRef(u),z=r.useRef(new Set),G=le(e),Q=g===j,[U,X]=r.useState({isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!G.isOnSubmit,errors:{}}),Y=r.useRef({isDirty:!ie,dirtyFields:!ie,touchedFields:!ie||G.isOnTouch,isValidating:!ie,isValid:!ie,errors:!ie}),ne=r.useRef(U);L.current=o,q.current=u;const se=()=>ne.current.isValid=b(N.current,E.current)&&h(ne.current.errors),be=r.useCallback((e,r,t=!1,c={},u)=>{let i=t||(({errors:e,name:r,error:t,validFields:s,fieldsWithValidation:c})=>{const u=n(t),i=a(e,r);return u&&!!i||!u&&!b(i,t,!0)||u&&a(c,r)&&!a(s,r)})({errors:ne.current.errors,error:r,name:e,validFields:N.current,fieldsWithValidation:E.current});const o=a(ne.current.errors,e);r?(oe(N.current,e),i=i||!o||!b(o,r,!0),f(ne.current.errors,e,r)):((a(E.current,e)||q.current)&&(f(N.current,e,!0),i=i||o),oe(ne.current.errors,e)),(i&&!s(t)||!h(c))&&k.current.next(Object.assign(Object.assign({},c),{isValid:q.current?u:se(),errors:ne.current.errors})),k.current.next({isValidating:!1})},[]),ge=r.useCallback((e,r)=>{const{_f:t}=a(p.current,e);if(t){const{ref:e,refs:n}=t,c=ue&&fe(e)&&s(r)?"":r;t.value=r,M(e)?(n||[]).forEach(e=>e.checked=e.value===c):I(e)&&!J(c)?e.files=c:P(e)?[...e.options].forEach(e=>e.selected=c.includes(e.value)):$(e)&&n?n.length>1?n.forEach(e=>e.checked=Array.isArray(c)?!!c.find(r=>r===e.value):c===e.value):n[0].checked=!!c:e.value=c}},[]),me=r.useCallback((e,r)=>{if(Y.current.isDirty){const t=Re();return e&&r&&f(t,e,r),!b(t,T.current)}return!1},[]),he=r.useCallback((e,r=!0)=>{if(Y.current.isDirty||Y.current.dirtyFields){const t=!b(a(T.current,e),H(a(p.current,e),!0)),n=a(ne.current.dirtyFields,e),s=ne.current.isDirty;t?f(ne.current.dirtyFields,e,!0):oe(ne.current.dirtyFields,e);const c={isDirty:me(),dirtyFields:ne.current.dirtyFields},u=Y.current.isDirty&&s!==c.isDirty||Y.current.dirtyFields&&n!==a(ne.current.dirtyFields,e);return u&&r&&k.current.next(c),u?c:{}}return{}},[]),ve=r.useCallback(async(e,r)=>{const t=(await Z(a(p.current,e),Q))[e];return be(e,t,r),n(t)},[be,Q]),pe=r.useCallback(async(e,r=[])=>{const{errors:t}=await q.current(B(p,T,!0),L.current,{criteriaMode:g,names:r,fields:de(O.current,p.current)});for(const r of e){const e=a(t,r);e?f(ne.current.errors,r,e):oe(ne.current.errors,r)}return t},[be,g]),xe=async e=>{for(const r in e){const n=e[r];if(n){const{_f:e}=n,r=t(n,["_f"]);if(e){const e=await Z(n,Q);e[n._f.name]?(f(ne.current.errors,n._f.name,e[n._f.name]),oe(N.current,n._f.name)):a(E.current,n._f.name)&&(f(N.current,n._f.name,!0),oe(ne.current.errors,n._f.name))}r&&await xe(r)}}},Ae=r.useCallback(async e=>{const r=n(e)?Object.keys(p.current):Array.isArray(e)?e:[e];let t;k.current.next({isValidating:!0}),u?t=h(await pe(r,n(e)?void 0:r)):n(e)?await xe(p.current):await Promise.all(r.map(async e=>await ve(e,null))),k.current.next({errors:ne.current.errors,isValidating:!1,isValid:u?t:se()})},[pe,ve]),Oe=r.useCallback((e,r,{shouldDirty:t,shouldValidate:n})=>{const s={};f(s,e,r);for(const c of ae(e,r))a(p.current,c)&&(ge(c,a(s,c)),t&&he(c),n&&Ae(c))},[Ae,ge,he]),je=r.useCallback((e,r,t)=>{const n=a(p.current,e);n&&n._f?(ge(e,r),t.shouldDirty&&he(e),t.shouldValidate&&Ae(e)):(Oe(e,r,t),z.current.has(e)&&(R.current.next({fields:r,name:e,isReset:!0}),(Y.current.isDirty||Y.current.dirtyFields)&&t.shouldDirty&&(f(ne.current.dirtyFields,e,m(r,a(T.current,e,[]),a(ne.current.dirtyFields,e,[]))),k.current.next({dirtyFields:ne.current.dirtyFields,isDirty:me(e,r)}))))},[he,ge,Oe]),ke=e=>W.current||C.current.has(e)||C.current.has((e.match(/\w+/)||[])[0]),Ve=e=>{let r;const t=re(z.current,e),s=a(p.current,e);return!s||h(T.current)&&n(s._f.value)||(r=n(s._f.value)?a(T.current,e):s._f.value,n(r)||t||ge(e,r)),r},Fe=r.useCallback(async({type:e,target:r,target:{value:t,type:s}})=>{let u,i,o=r.name;const l=a(p.current,o);if(l){const d=s?H(l):t,y=e===v,{isOnBlur:b,isOnChange:m}=le(c),x=(({isOnBlur:e,isOnChange:r,isOnTouch:t,isTouched:n,isReValidateOnBlur:s,isReValidateOnChange:c,isBlurEvent:u,isSubmitted:i,isOnAll:a})=>!a&&(!i&&t?!(n||u):(i?s:e)?!u:!(i?c:r)||u))(Object.assign({isBlurEvent:y,isTouched:!!a(ne.current.touchedFields,o),isSubmitted:ne.current.isSubmitted,isReValidateOnBlur:b,isReValidateOnChange:m},G)),A=!y&&ke(o);n(d)||(l._f.value=d);const O=he(o,!1);y&&Y.current.touchedFields&&!a(ne.current.touchedFields,o)&&(f(ne.current.touchedFields,o,!0),O.touchedFields=ne.current.touchedFields);let j=!h(O)||A;if(x)return!y&&V.current.next({name:o,type:e,value:d}),j&&k.current.next(A?{}:O);if(k.current.next({isValidating:!0}),q.current){const{errors:e}=await q.current(B(p,T,!0),L.current,{criteriaMode:g,fields:de([o],p.current),names:[o]}),t=ne.current.isValid;if(u=a(e,o),$(r)&&!u){const r=ee(o),t=a(e,r,{});t.type&&t.message&&(u=t),(t||a(ne.current.errors,r))&&(o=r)}i=h(e),t!==i&&(j=!0)}else u=(await Z(l,Q))[o];!y&&V.current.next({name:o,type:e,value:d}),be(o,u,j,O,i)}},[]);function Re(e){const r=D.current?B(p,T):l;return n(e)?r:J(e)?a(r,e):e.map(e=>a(r,e))}const Se=r.useCallback(async(e={})=>{if(u){const{errors:r}=await q.current(Object.assign(Object.assign({},B(p,T,!0)),e),L.current,{criteriaMode:g,fields:de(O.current,p.current)}),t=h(r);ne.current.isValid!==t&&k.current.next({isValid:t})}else se()},[g]),we=r.useCallback((e,r,t)=>{const{fields:s,name:c}=S.current,u=Array.isArray(e);let i=D.current?Re():n(r)?T.current:u?r||{}:{[e]:r};if(s&&(c?f(i,c,s):i=s,S.current={fields:void 0,name:void 0}),n(e))return W.current=!0,i;const o=[];for(const r of u?e:[e])t&&C.current.add(r),o.push(a(i,r));return u?o:o[0]},[]),Ce=(e,r,t)=>{let n=a(p.current,e);if(n){const s=(e=>M(e)||$(e))(r);if((s?Array.isArray(n._f.refs)&&i(n._f.refs).find(e=>r.value===e.value&&e===r):r===n._f.ref)||!n)return;n={_f:s?Object.assign(Object.assign({},n._f),{refs:[...i(n._f.refs||[]).filter(e=>fe(e)&&document.contains(e)),r],ref:{type:r.type,name:e}}):Object.assign(Object.assign({},n._f),{ref:r})},f(p.current,e,n);const c=Ve(e);s&&Array.isArray(c)&&b(a(p.current,e)._f.value,c)||(a(p.current,e)._f.value=H(a(p.current,e))),t&&!G.isOnSubmit&&n&&Y.current.isValid&&Z(n,Q).then(r=>{h(r)?f(N.current,e,!0):oe(N.current,e),ne.current.isValid&&!h(r)&&X(Object.assign(Object.assign({},ne.current),{isValid:se()}))})}},De=r.useCallback((e,r)=>(f(p.current,e,{_f:Object.assign(Object.assign(Object.assign({},a(p.current,e)?Object.assign({ref:a(p.current,e)._f.ref},a(p.current,e)._f):{ref:{name:e}}),{name:e}),r)}),r&&f(E.current,e,!0),O.current.add(e),Ve(e),ye?{}:{name:e,onChange:Fe,onBlur:Fe,ref:t=>t&&Ce(e,t,r)}),[T.current]),_e=r.useCallback((e,r)=>async t=>{t&&t.preventDefault&&(t.preventDefault(),t.persist());let n=B(p,T,!0);k.current.next({isSubmitting:!0});try{if(q.current){const{errors:e,values:r}=await q.current(n,L.current,{criteriaMode:g,fields:de(O.current,p.current)});ne.current.errors=e,n=r}else await xe(p.current);h(ne.current.errors)&&Object.keys(ne.current.errors).every(e=>a(n,e))?(k.current.next({errors:{},isSubmitting:!0}),await e(n,t)):(r&&await r(ne.current.errors,t),y&&d(p.current,e=>a(ne.current.errors,e),O.current))}finally{ne.current.isSubmitting=!1,k.current.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:h(ne.current.errors),submitCount:ne.current.submitCount+1,errors:ne.current.errors})}},[y,Q,g]);return r.useEffect(()=>{u&&Y.current.isValid&&Se()},[T.current]),r.useEffect(()=>{D.current=!0;const e=k.current.subscribe({next(e={}){_(e,Y.current,!0)&&(ne.current=Object.assign(Object.assign({},ne.current),e),X(ne.current))}}),r=R.current.subscribe({next(e){if(e.fields&&e.name&&(S.current=e,Y.current.isValid)){const r=Re();f(r,e.name,e.fields),Se(r)}}});return()=>{V.current.unsubscribe(),e.unsubscribe(),r.unsubscribe()}},[]),{control:r.useMemo(()=>({register:De,isWatchAllRef:W,watchFieldsRef:C,getFormIsDirty:me,formStateSubjectRef:k,fieldArraySubjectRef:R,controllerSubjectRef:F,watchSubjectRef:V,watchInternal:we,fieldsRef:p,validFieldsRef:N,fieldsWithValidationRef:E,fieldArrayNamesRef:z,readFormStateRef:Y,formStateRef:ne,defaultValuesRef:T,fieldArrayDefaultValuesRef:w}),[]),formState:te(ie,U,Y),trigger:Ae,register:De,handleSubmit:_e,watch:r.useCallback((function(e,r){return K(e)?V.current.subscribe({next:t=>e(we(void 0,r),t)}):we(e,r,!0)}),[]),setValue:r.useCallback((e,r,t)=>{je(e,r,t||{}),ke(e)&&k.current.next({}),V.current.next({name:e,value:r})},[je,Ae]),getValues:r.useCallback(Re,[]),reset:r.useCallback((e,r={})=>{const t=e||T.current;if(ue&&!r.keepValues)for(const e of Object.values(p.current))if(e&&e._f){const{ref:r,refs:t}=e._f,n=Array.isArray(t)?t[0]:r;if(fe(n))try{n.closest("form").reset();break}catch(e){}}!r.keepDefaultValues&&(T.current=Object.assign({},t)),r.keepValues||(p.current={},F.current.next(Object.assign({},t)),V.current.next({value:Object.assign({},t)}),R.current.next({fields:Object.assign({},t),isReset:!0})),(({keepErrors:e,keepDirty:r,keepIsSubmitted:t,keepTouched:n,keepIsValid:s,keepSubmitCount:c})=>{s||(N.current={},E.current={}),C.current=new Set,W.current=!1,k.current.next({submitCount:c?ne.current.submitCount:0,isDirty:!!r&&ne.current.isDirty,isSubmitted:!!t&&ne.current.isSubmitted,isValid:s?ne.current.isValid:!G.isOnSubmit,dirtyFields:r?ne.current.dirtyFields:{},touchedFields:n?ne.current.touchedFields:{},errors:e?ne.current.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})})(r)},[]),clearErrors:r.useCallback(e=>{e&&(Array.isArray(e)?e:[e]).forEach(e=>oe(ne.current.errors,e)),k.current.next({errors:e?ne.current.errors:{}})},[]),unregister:r.useCallback((e,r={})=>{for(const t of e?Array.isArray(e)?e:[e]:Object.keys(O.current))O.current.delete(t),a(p.current,t)&&(r.keepIsValid||(oe(E.current,t),oe(N.current,t)),!r.keepValues&&oe(ne.current.errors,t),!r.keepErrors&&oe(p.current,t),!r.keepDirty&&oe(ne.current.dirtyFields,t),!r.keepTouched&&oe(ne.current.touchedFields,t),!r.keepDefaultValues&&oe(T.current,t),V.current.next({name:t}));k.current.next(Object.assign(Object.assign(Object.assign({},ne.current),r.keepDirty?{isDirty:me()}:{}),u?{}:{isValid:se()})),r.keepIsValid||Se()},[]),setError:r.useCallback((e,r,t)=>{const n=(a(p.current,e)||{_f:{}})._f.ref;f(ne.current.errors,e,Object.assign(Object.assign({},r),{ref:n})),k.current.next({errors:ne.current.errors,isValid:!1}),t&&t.shouldFocus&&n&&n.focus&&n.focus()},[])}},e.useFormContext=ge,e.useFormState=ke,e.useWatch=function({control:e,name:t,defaultValue:s}){const c=ge(),{watchInternal:i,defaultValuesRef:o,watchSubjectRef:l}=e||c.control,[f,d]=r.useState(n(s)?Array.isArray(t)?t.reduce((e,r)=>Object.assign(Object.assign({},e),{[r]:a(o.current,r)}),{}):J(t)?a(o.current,t):o.current:s);return r.useEffect(()=>{const e=l.current.subscribe({next:({name:e,value:r})=>{d(J(e)&&t===e&&!n(r)?r:t&&u(r)?a(r,t,s):i(t,s))}});return()=>e.unsubscribe()},[t]),f},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.production.min.js.map
